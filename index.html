<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ğŸ‘£ æ—…éŠè¡Œç¨‹æ›¸ ğŸ‘£</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@700;900&display=swap');
        body { font-family: 'Noto Sans TC', sans-serif; background-color: #E0F2FE; color: #1A1A1A; }
        .neo-brutal { border: 4px solid #000; box-shadow: 6px 6px 0px #000; transition: all 0.1s; cursor: pointer; background-color: white; }
        .neo-brutal:active { box-shadow: 0px 0px 0px #000; transform: translate(4px, 4px); }
        .page { display: none; padding-bottom: 120px; animation: fadeIn 0.2s ease-out; }
        .page-active { display: block; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .delete-btn { border: 2px solid #000; background: #FF4B4B; color: white; width: 24px; height: 24px; display: flex; align-items: center; justify-content: center; font-size: 12px; font-weight: 900; }
    </style>
</head>
<body class="p-4">

    <div id="page-home" class="page page-active">
        <header class="mb-6">
            <h1 class="text-4xl font-black italic">PANGUI! ğŸ¶</h1>
            <p class="font-bold text-blue-600">ä¸‹ä¸€ç«™ï¼šæ—¥æœ¬æ±äº¬ ğŸ‡¯ğŸ‡µ</p>
        </header>
        
        <div class="grid grid-cols-2 gap-4">
            <div onclick="showPage('page-itinerary')" class="col-span-2 neo-brutal p-6 relative h-40 overflow-hidden">
                <span class="absolute right-[-10px] bottom-[-10px] text-8xl opacity-10">ğŸ—¾</span>
                <h2 class="text-2xl font-black">æŸ¥çœ‹è¡Œç¨‹è¡¨</h2>
                <div class="mt-2 text-orange-600 font-bold italic">GO! GO! ></div>
            </div>
            <div onclick="showPage('page-calc')" class="neo-brutal bg-orange-400 p-4 text-center">
                <span class="text-3xl">ğŸ’´</span><p class="font-black mt-1">åŒ¯ç‡è¨˜å¸³</p>
            </div>
            <div onclick="showPage('page-list-luggage')" class="neo-brutal bg-green-300 p-4 text-center">
                <span class="text-3xl">ğŸ“¦</span><p class="font-black mt-1">è¡Œææ¸…å–®</p>
            </div>
            <div onclick="showPage('page-list-gifts')" class="neo-brutal bg-purple-300 p-4 text-center">
                <span class="text-3xl">ğŸ</span><p class="font-black mt-1">ä¼´æ‰‹ç¦®</p>
            </div>
            <div onclick="clearAllData()" class="neo-brutal bg-red-300 p-4 text-center">
                <span class="text-3xl">ğŸ—‘ï¸</span><p class="font-black mt-1">é‡è¨­è³‡æ–™</p>
            </div>
        </div>
    </div>

    <div id="page-itinerary" class="page">
        <button onclick="showPage('page-home')" class="mb-4 font-black">â† è¿”å›é¦–é </button>
        <h2 class="text-3xl font-black mb-4">æ—…éŠæ™‚é–“è»¸ ğŸ“</h2>
        
        <div class="flex space-x-3 overflow-x-auto no-scrollbar mb-6 pb-2">
            <button class="flex-none w-16 h-20 neo-brutal bg-orange-400 flex flex-col items-center justify-center font-black"><span>01</span><span>10</span></button>
            <button class="flex-none w-16 h-20 neo-brutal bg-white flex flex-col items-center justify-center font-black"><span>01</span><span>11</span></button>
            <button class="flex-none w-16 h-20 neo-brutal bg-white flex flex-col items-center justify-center font-black"><span>01</span><span>12</span></button>
            <button class="flex-none w-16 h-20 neo-brutal bg-white flex flex-col items-center justify-center font-black"><span>01</span><span>13</span></button>
            <button class="flex-none w-16 h-20 neo-brutal bg-white flex flex-col items-center justify-center font-black"><span>01</span><span>14</span></button>
        </div>

        <div id="itinerary-list" class="space-y-6 border-l-4 border-black ml-4 pl-6 relative">
            </div>
    </div>

    <div id="page-calc" class="page">
        <button onclick="showPage('page-home')" class="mb-4 font-black">â† è¿”å›</button>
        <div class="neo-brutal bg-black text-white p-6 mb-4">
            <div class="text-4xl font-black text-orange-400">Â¥ <span id="jpy-val">0</span></div>
            <div class="mt-2 text-2xl font-black text-white">NT$ <span id="twd-val">0</span></div>
        </div>
        <div class="grid grid-cols-3 gap-3 mb-6">
            <button onclick="calc(1)" class="neo-brutal py-4 text-2xl font-black">1</button>
            <button onclick="calc(2)" class="neo-brutal py-4 text-2xl font-black">2</button>
            <button onclick="calc(3)" class="neo-brutal py-4 text-2xl font-black">3</button>
            <button onclick="calc(4)" class="neo-brutal py-4 text-2xl font-black">4</button>
            <button onclick="calc(5)" class="neo-brutal py-4 text-2xl font-black">5</button>
            <button onclick="calc(6)" class="neo-brutal py-4 text-2xl font-black">6</button>
            <button onclick="calc(7)" class="neo-brutal py-4 text-2xl font-black">7</button>
            <button onclick="calc(8)" class="neo-brutal py-4 text-2xl font-black">8</button>
            <button onclick="calc(9)" class="neo-brutal py-4 text-2xl font-black">9</button>
            <button onclick="calc('C')" class="neo-brutal bg-red-400 py-4 text-2xl font-black">C</button>
            <button onclick="calc(0)" class="neo-brutal py-4 text-2xl font-black">0</button>
            <button onclick="saveExpense()" class="neo-brutal bg-orange-400 py-4 text-xl font-black">SAVE</button>
        </div>
        <h3 class="font-black mb-2 italic underline">EXPENSE HISTORY</h3>
        <div id="expense-history" class="space-y-2"></div>
    </div>

    <div id="page-list-luggage" class="page">
        <button onclick="showPage('page-home')" class="mb-4 font-black">â† è¿”å›</button>
        <h2 class="text-3xl font-black mb-6">è¡Œææª¢æŸ¥ ğŸ’</h2>
        <div id="luggage-list" class="space-y-3"></div>
    </div>

    <div id="page-list-gifts" class="page">
        <button onclick="showPage('page-home')" class="mb-4 font-black">â† è¿”å›</button>
        <h2 class="text-3xl font-black mb-6">ä¼´æ‰‹ç¦®æ¸…å–® ğŸ</h2>
        <div id="gifts-list" class="space-y-3"></div>
    </div>

    <div class="fixed bottom-6 left-0 right-0 px-8 flex justify-center">
        <button onclick="handleGlobalAdd()" class="w-full max-w-sm neo-brutal bg-orange-400 py-4 text-xl font-black shadow-[8px_8px_0px_#000]">
            ï¼‹ æ–°å¢ç´€éŒ„
        </button>
    </div>

    <script>
        // --- è³‡æ–™ç®¡ç† ---
        let db = JSON.parse(localStorage.getItem('travel_v2')) || {
            itinerary: [{time: "09:00", title: "æŠµé”æ©Ÿå ´ âœˆï¸"}],
            expenses: [],
            luggage: [{text: "è­·ç…§", checked: false}],
            gifts: [{text: "è–¯æ¢ä¸‰å…„å¼Ÿ", checked: false}]
        };

        function saveDB() {
            localStorage.setItem('travel_v2', JSON.stringify(db));
            renderAll();
        }

        function deleteItem(type, index) {
            if (confirm("è¦åˆªé™¤é€™å€‹é …ç›®å—ï¼Ÿ")) {
                db[type].splice(index, 1);
                saveDB();
            }
        }

        // --- è·¯ç”± ---
        let currentPage = 'page-home';
        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('page-active'));
            document.getElementById(pageId).classList.add('page-active');
            currentPage = pageId;
            window.scrollTo(0,0);
        }

        // --- åŠŸèƒ½å¯¦ä½œ ---
        function handleGlobalAdd() {
            if (currentPage === 'page-itinerary' || currentPage === 'page-home') {
                const time = prompt("æ™‚é–“:", "12:00");
                const title = prompt("è¡Œç¨‹å…§å®¹:");
                if (title) { db.itinerary.push({time, title}); saveDB(); showPage('page-itinerary'); }
            } else if (currentPage === 'page-list-luggage') {
                const text = prompt("æ–°å¢ç‰©å“:");
                if (text) { db.luggage.push({text, checked: false}); saveDB(); }
            } else if (currentPage === 'page-list-gifts') {
                const text = prompt("æ–°å¢æƒ³è²·çš„ä¼´æ‰‹ç¦®:");
                if (text) { db.gifts.push({text, checked: false}); saveDB(); }
            }
        }

        let jpy = "0";
        function calc(val) {
            if (val === 'C') jpy = "0";
            else if (jpy === "0") jpy = val.toString();
            else jpy += val.toString();
            document.getElementById('jpy-val').innerText = jpy;
            document.getElementById('twd-val').innerText = Math.round(parseInt(jpy) * 0.21);
        }

        function saveExpense() {
            if (jpy === "0") return;
            const note = prompt("é€™ç­†éŒ¢èŠ±åœ¨å“ªï¼Ÿ", "åˆé¤");
            if (note) {
                db.expenses.unshift({note, jpy: jpy, twd: Math.round(parseInt(jpy) * 0.21)});
                jpy = "0"; calc('C'); saveDB();
            }
        }

        function toggleCheck(type, index) {
            db[type][index].checked = !db[type][index].checked;
            saveDB();
        }

        // --- æ¸²æŸ“æ¸²æŸ“ ---
        function renderAll() {
            // è¡Œç¨‹
            document.getElementById('itinerary-list').innerHTML = db.itinerary.map((i, idx) => `
                <div class="neo-brutal p-4 relative mb-4 group">
                    <div class="absolute -left-[38px] top-4 w-6 h-6 rounded-full bg-orange-400 border-4 border-black"></div>
                    <div class="flex justify-between items-start">
                        <div>
                            <span class="text-sm font-black text-orange-600">${i.time}</span>
                            <h4 class="font-black text-lg">${i.title}</h4>
                        </div>
                        <button onclick="deleteItem('itinerary', ${idx})" class="delete-btn">Ã—</button>
                    </div>
                </div>
            `).join('');

            // è¨˜å¸³æ­·å²
            document.getElementById('expense-history').innerHTML = db.expenses.map((e, idx) => `
                <div class="flex justify-between items-center p-3 bg-white border-2 border-black font-bold mb-2">
                    <span class="flex-1">ğŸ± ${e.note}</span>
                    <span class="mr-4 text-sm italic text-gray-500">Â¥${e.jpy}</span>
                    <span class="font-black text-orange-600">NT$${e.twd}</span>
                    <button onclick="deleteItem('expenses', ${idx})" class="ml-2 delete-btn">Ã—</button>
                </div>
            `).join('');

            // æ¸…å–®
            renderList('luggage-list', 'luggage', db.luggage);
            renderList('gifts-list', 'gifts', db.gifts);
        }

        function renderList(targetId, type, data) {
            document.getElementById(targetId).innerHTML = data.map((item, idx) => `
                <div class="neo-brutal p-4 flex justify-between items-center font-black ${item.checked ? 'bg-green-100' : ''}">
                    <div class="flex items-center flex-1" onclick="toggleCheck('${type}', ${idx})">
                        <div class="w-6 h-6 border-4 border-black mr-3 ${item.checked ? 'bg-black' : 'bg-white'}"></div>
                        <span class="${item.checked ? 'line-through text-gray-500' : ''}">${item.text}</span>
                    </div>
                    <button onclick="deleteItem('${type}', ${idx})" class="delete-btn">Ã—</button>
                </div>
            `).join('');
        }

        function clearAllData() { if(confirm("ç¢ºå®šé‡è¨­ï¼Ÿ")) { localStorage.clear(); location.reload(); } }

        renderAll();
    </script>
</body>
</html>
